<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Panel del Barbero</title>

<style>
*{box-sizing:border-box}
body{font-family:Arial, sans-serif; background:#121212; color:#eee; padding:20px;}
.box{max-width:1100px; margin:auto; background:#1f1f1f; padding:20px; border-radius:14px;}
h1{margin:0 0 10px; color:#D4AF37;}
.filters{display:flex; gap:10px; flex-wrap:wrap; margin:15px 0;}
input, select, button{padding:10px; border-radius:10px; border:1px solid #333; background:#2b2b2b; color:#eee;}
button{cursor:pointer; background:#D4AF37; color:#111; font-weight:bold;}
table{width:100%; border-collapse:collapse; margin-top:15px;}
th,td{padding:10px; border-bottom:1px solid #333; text-align:left;}
th{color:#D4AF37;}
.tag{padding:4px 8px; border-radius:999px; font-size:12px; display:inline-block;}
.ok{background:#28a745;}
.bad{background:#dc3545;}
.done{background:#007bff;}
</style>
</head>

<body>
<div class="box">

<h1>Panel de Ericson ðŸ’ˆ</h1>

<form method="GET" class="filters">
  <select name="solo">
    <option value="hoy">Hoy</option>
    <option value="manana">MaÃ±ana</option>
    <option value="todas">Todas</option>
  </select>

  <select name="estado">
    <option value="activas">Activas</option>
    <option value="atendidas">Atendidas</option>
    <option value="canceladas">Canceladas</option>
    <option value="todas">Todas</option>
  </select>

  <input name="q" placeholder="Buscar cliente/servicio" />
  <button type="submit">Aplicar</button>
</form>

<table>
<thead>
<tr>
  <th>Fecha</th>
  <th>Hora</th>
  <th>Cliente</th>
  <th>Servicio</th>
  <th>Precio</th>
  <th>Estado</th>
  <th>AcciÃ³n</th>
</tr>
</thead>

<tbody>
{% for c in citas %}
<tr>
  <td>{{ c.fecha }}</td>
  <td>{{ c.hora }}</td>
  <td>{{ c.cliente }}</td>
  <td>{{ c.servicio }}</td>
  <td>â‚¡{{ c.precio }}</td>

  <td>
    {% if c.servicio == "CITA CANCELADA" %}
      <span class="tag bad">Cancelada</span>
    {% elif c.servicio == "CITA ATENDIDA" %}
      <span class="tag done">Atendida</span>
    {% else %}
      <span class="tag ok">Activa</span>
    {% endif %}
  </td>

  <td>
    {% if c.servicio not in ["CITA CANCELADA","CITA ATENDIDA"] %}
      <form method="POST" action="/atendida">
        <input type="hidden" name="id" value="{{ c.id }}">
        <button type="submit">Marcar atendida</button>
      </form>
    {% endif %}
  </td>
</tr>
{% endfor %}
</tbody>
</table>

</div>

<script>
const params = new URLSearchParams(window.location.search);
const solo = params.get("solo");
const estado = params.get("estado");
if (solo) document.querySelector('select[name="solo"]').value = solo;
if (estado) document.querySelector('select[name="estado"]').value = estado;
const q = params.get("q");
if (q) document.querySelector('input[name="q"]').value = q;
</script>

</body>
</html>
